---
import SpeakButton from './SpeakButton.astro';
import type { CharacterData } from '../lib/dataService';

interface Props {
  charData: CharacterData | undefined;
  charIndex: number;
}

const { charData, charIndex } = Astro.props;
---

{charData ? (
  <div class="mb-4">
    <p class="text-sm font-bold text-slate-600 mb-2 flex items-center">
      {charIndex}. Từ gốc:{' '}
      <span class="chinese-font text-lg text-blue-800 mr-2">{charData.hanzi}</span>
      <span>({charData.pinyin}, {charData.hanviet})</span>
      <SpeakButton text={charData.hanzi} size="small" variant="secondary" class="ml-2" />
    </p>
    {charData.words && charData.words.length > 0 ? (
      <div class="flex flex-wrap gap-2 text-sm">
        {charData.words.map(word => (
          <button
            class="speak-btn bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full font-medium whitespace-nowrap text-sm md:text-base hover:bg-indigo-200 transition duration-150"
            data-speak-text={word.hanzi}
          >
            <span class="chinese-font font-bold mr-1">{word.hanzi}</span>
            <span>({word.pinyin}, {word.hanviet})</span>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="ml-1 inline"
            >
              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" />
              <path d="M15.54 8.46a2.16 2.16 0 0 1 0 3.08" />
            </svg>
          </button>
        ))}
      </div>
    ) : (
      <p class="text-slate-500 italic text-sm">Không có dữ liệu từ ghép mở rộng cho từ này.</p>
    )}
  </div>
) : (
  <p class="text-slate-500 italic text-center text-base mb-4">
    Dữ liệu phân tích từ gốc chưa được cung cấp cho thẻ này.
  </p>
)}
